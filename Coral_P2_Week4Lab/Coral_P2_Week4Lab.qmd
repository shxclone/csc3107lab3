---
title: "Team Coral_P2_Week 4 Lab"
author: "Team Coral"
format: html
editor: visual
---

```{r}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
library(tidyverse)
```

# 1 Visualizing the Distribution of Travelers on the Titanic

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

## 1.1 Bar Chart of Travelers by Class

```{r}
#| label: bar-chart-class
titanic <- read_csv("data/titanic.csv")
titanic_count <- titanic %>% count(class)

ggplot(titanic_count, aes(x = class, y = n)) +
  geom_col(fill = "steelblue") +
  geom_text(aes(label = n), hjust = -0.1) +
  coord_flip() +
  labs(
    title = "Number of Travelers by Class",
    caption = "Source: Encyclopedia Titanica (2023)"
  ) +
  theme_minimal() +
  theme(axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        axis.text.x = element_blank(),
        axis.ticks = element_blank())
```

## 1.2 Dodged Bar Chart of Travelers by Class and Survival

```{r}
#| label: dodged-bar-chart

titanic_survived <- titanic %>% count(class, survived)

ggplot(titanic_survived, aes(x = class, y = n, fill = survived)) +
  geom_col(position = position_dodge(width = 0.8)) +
  geom_text(aes(label = n, color = survived),  # use 'color' aesthetic mapped to 'survived'
            position = position_dodge(width = 0.8), 
            hjust = -0.1) +
  coord_flip() +
  labs(
    title = "Survival by Class",
    fill = "Survived",
    color = "Survived"
  ) +
  theme_minimal() +
  theme(axis.title.x = element_blank(),
        axis.title.y = element_blank(),
        axis.text.x = element_blank(),
        axis.ticks = element_blank())

```

## 1.3 Mosaic Plot (Alternative: Heatmap with Matching Label Colors)

```{r}
#| label: heatmap-alternative

heatmap_data <- titanic %>% count(class, survived)

ggplot(heatmap_data, aes(x = class, y = survived, fill = survived)) +
  geom_tile(color = "white") +
  geom_text(aes(label = n, color = survived), fontface = "bold") +
  labs(
    title = "Heatmap of Class vs Survival",
    fill = "Survived",
    color = "Survived"
  ) +
  theme_minimal()
```
